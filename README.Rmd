---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# autoscore

The goal of autoscore is to score the accuracy of speech perception (often in several situations such as noise, dysarthria, hearing loss, etc.). It uses a flexible number of rules that help decide if a response set of words match a target set of words. Each rule can be applied or removed in each situation to best meet the needs of the researcher.

The rules are:

1. `position_rule` = how close the word has to be in the order of the target (e.g., `c("one", "two") with c("three", "one", "two")` has "one" match one position off of where it should be and same with "two")
2. `homophone_rule` = should we use homophone list (`TRUE` or `FALSE`)
3. `stemmed_rule` = should we stem all words (i.e., remove all suffixes); default is `TRUE`
3. `pasttense_rule` = -d and -ed removed (is not applied when `stemmed_rule` is applied); default is `TRUE`
4. `a_the_rule` = a and the are the same
5. `plural_rule` = remove plurals (is not applied when `stemmed_rule` is applied); default is `TRUE`
6. `firstpart_rule` = embedded at beginning of word or at the end of the word ("bat" :: "batman"); uses a partial matching heuristic
7. `alternate_spell_rule` = a researcher provided alternate spellings of words in the target; is triggered when the researcher provides a data frame of original and alternate spellings

## Design

The API of the `R` package is simple. A single call to `autoscore()` with the formatted data will run everything for you. This function is a composite of several sub-functions that do various jobs:

- `select_cols()` -- The first function which takes the data and gets it in the right format for analysis.
- `split_clean()` -- Using the cleaned data from `select_cols()`, this uses `stringr` to turn the phrases into individual words.
- `alternate_fun()` -- If a data.frame of alternate spellings is provided, this function will find and normalize all alternate spellings to match the original spelling as defined by the researcher.
- `homophones_fun()` -- If homophones are used (according to the `homophone_rule`), this function finds and normalizes all homophones as found in the `data(homophones)` found in this package.
- `match_position_basic()` -- This function is the workhorse of the package. It takes the cleaned (and possibly homophone normalized) data and does three main things: 1) applies all the rules except for the `position_rule`, 2) finds the matches between the responses and the targets, and 3) reports how far away the matches are from each other.
- `count_matches()` -- Finally, this function takes the information from `match_position_basic()` and counts the number of matches based on the `position_rule`.


## Use of the Online Tool

The online tool will be developed shortly...




## Use of the R Package

An example of the use of `autoscore` is below. We will use the example data set provided in the package.

```{r}
library(tidyverse)
library(autoscore)

data("example_data")
example_data
```

First, let's use all the defaults and look at the first 10 rows of the output.
```{r}
example_data %>%
  autoscore() %>%   ## using all the defaults
  as.tibble()       ## to shorted output
```

Next, let's change some of the rules.
```{r}
example_data %>%
  autoscore(position_rule = 2, stemmed_rule = FALSE, plurals_rule = FALSE) %>%
  as.tibble()
```

We can also change the output type to "none" to get all the data from the computation.
```{r}
example_data %>%
  autoscore(output = "none")
```

To use the alternate spelling, let's create a small `data.frame` that we can provide `autoscore()`. In the data frame below, the original spellings are the generally accepted spellings while the alternate spellings are those that may be misspelled or otherwise not generally used.

```{r}
alternate_df <- data_frame(
  original = c("model",
               "treason",
               "duck"),
  alternate = c("modal, moddel",
                "treeson",
                "dock")
)
alternate_df
```

Using this, we can provide it to the `autoscore()` function with the `alternate_df` argument.

```{r}
example_data %>%
  autoscore::autoscore(alternate_df = alternate_df) %>%
  as.tibble()
```


In each of these examples, it is clear that the human and "robot" agree the majority of the time. The times that they disagree, it is usually predictably a human error or a subjective judgement that the researcher will have to consider (for example by including alternate spellings of words as we just demonstrated).

Finally, the session information from the computer that ran this short tutorial.
```{r}
devtools::session_info("autoscore")
```


